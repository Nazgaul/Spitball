<template>
    <div>
        <v-bottom-nav
                height="48px"
                :active.sync="activeBtn"
                :value="true"
                fixed
                color="#f5f5f5"
                :app="$vuetify.breakpoint.xsOnly && getMobileFooterState()"
                class="notransition mob-footer-navigation"
        >
            <v-btn flat color="teal" value="feed" @click="changeActiveTab(tabs.feed)">
                <span class="mob-footer-title" v-language:inner>mobileFooter_action_feed</span>
                <v-icon class="mob-footer-icon" v-if="activeBtn !== tabs.feed">sbf-icon-feed</v-icon>
                <v-icon class="mob-footer-icon" v-else>sbf-icon-feed-selected</v-icon>

            </v-btn>
            <v-btn flat color="teal" value="earners"  @click="changeActiveTab(tabs.earners)">
                <span class="mob-footer-title" v-language:inner>mobileFooter_action_earners</span>
                <v-icon class="mob-footer-icon" v-if="activeBtn !== tabs.earners">sbf-graduation</v-icon>
                <v-icon class="mob-footer-icon" color="#43425d" v-else>sbf-graduation</v-icon>
            </v-btn>

            <v-btn flat color="teal" value="promotions"  @click="changeActiveTab(tabs.promotions)">
                <span class="mob-footer-title" v-language:inner>mobileFooter_action_promotion</span>
                <v-icon class="mob-footer-icon" v-if="activeBtn !== tabs.promotions">sbf-icon-promotions</v-icon>
                <v-icon class="mob-footer-icon" v-else>sbf-icon-promotions-selected</v-icon>
                <span class="unread-circle" v-show="totalUnread > 0">{{totalUnread}}</span>
            </v-btn>
        </v-bottom-nav>
    </div>
</template>
<script>
    import { mapActions, mapGetters } from 'vuex';

    export default {
        name: "mobileFooter",
        props: {
            onStepChange: {
                type: Function,
                required: false
            },
        },
        data() {
            return {
                // activeBtn: 'feed',
                showNav: true,
                tabs: this.getFooterEnumsState()
            }
        },

        computed: {
            ...mapGetters(['getTotalUnread', 'accountUser', 'getCurrentActiveTabName']),
            totalUnread(){
                return this.getTotalUnread
            },
            activeBtn:{
                get(){
                    return this.getCurrentActiveTabName;
                },
                set(val){
                    this.changeFooterActiveTab(val)
                }
            }
        },
        methods: {
            ...mapActions(['changemobileMarketingBoxState', 'changeFooterActiveTab', 'updateLoginDialogState']),
            ...mapGetters(["getFooterEnumsState", "getMobileFooterState"]),
            changeActiveTab(val){
                if (this.accountUser == null && val === 'promotions') {
                    this.updateLoginDialogState(true);
                    setTimeout(()=>{
                        //this.activeBtn = 'feed';
                        this.changeFooterActiveTab('feed');
                    }, 200)
                    
                }else{
                    this.onStepChange();
                    //this.activeBtn = val;
                    this.changeFooterActiveTab(val);
                }
                
            }
        },
    }
</script>

<style lang="less">
    @import "../../../styles/mixin.less";
    .v-bottom-nav{
        &.mob-footer-navigation{
            box-shadow: none;
            border-top: 1px solid #d7d7d7!important;
        }
    }

    .mob-footer-icon{
        font-size: 20px;
    }
    .unread-circle{
        position: absolute;
        top: 10px;
        right: 30px;
        background: #4452fc;
        color: #fff;
        border-radius: 50%;
        height: 13px;
        width: 13px;
        display: flex;
        font-size: 10px;
        justify-content: center;
        flex-direction: column;
        text-align: center;
    }
    .v-item-group.v-bottom-nav .v-btn--active .v-btn__content {
        font-size: 12px;
        color: @color-blue-new;
    }
    .v-item-group.v-bottom-nav .v-btn--active {
        padding-top: 8px;
    }

    .mob-footer-title {
        opacity: 0.9;
        font-family: @fontOpenSans;
        /*font-size: 9px;*/
        font-weight: 500;
        letter-spacing: -0.1px;
        text-align: center;
    }

</style>