<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="Zbang.Zbox.Domain"
                   namespace="Zbang.Zbox.Domain">
  <class name="CommentReplies"
       table="CommentReplies">

    <id name="Id" column="CommentRepliesId" type="long">
      <generator class="native"/>
    </id>

    <property name="IsDeleted"/>
    <many-to-one name="Author" class="User" column="AuthorId" not-null="true"/>
    
    <!--<many-to-one name="Parent" class="CommentReplies" column="ParentId" />-->
    
    <property name="CommentText" type="StringClob" not-null="true">
      <column name="CommentText" sql-type="NTEXT"/>
    </property>  

    <component name="DateTimeUser" class="UserTimeDetails">
      <property name="CreationTime" not-null="true" insert="true" update="false" />
      <property name="UpdateTime"  not-null="true" insert="true"  />
      <property name="CreatedUser"  not-null="true" insert="true" update="false"/>
      <property name="UpdatedUser"  not-null="true" insert="true" />
    </component>
    <many-to-one name="Parent" class="Comment" column="ParentId" />
    <joined-subclass name="Comment" table="Comment">
      <key column="CommentId"></key>      
      <bag name="Replies" table="CommentReplies" cascade="all-delete-orphan" inverse="false" lazy="true">
        <key column="ParentId" />
        <one-to-many class="CommentReplies"/>
      </bag>
      <many-to-one name="Item" class="Item" column="ItemId" not-null="false" />
      <many-to-one name="Box" class="Box" column="BoxId" not-null="false"/>
    </joined-subclass>
              
  </class>
</hibernate-mapping>