@using Zbang.Cloudents.Mvc4WebRole.Views.Shared.Resources
@using Zbang.Cloudents.Mvc4WebRole.Views.Item.Resources
@{
    const string svgUrl = "~/images/site/itemIcons.svg";
}
<div class="full-screen itemPage" srph-infinite-scroll="i.loadMore()" container="true" unregister-scroll="true">
    <header>
        <div layout="row" layout-align="space-between center">
            <div class="fb-like" ng-class="{blue : i.details.like}">
                <button user-not-register-popup="click" type="button" ng-click="i.like()" ga-track-event="['itemPage', 'like item']">
                    <div class="content">
                        @Html.Svg("~/images/site/box-icons.svg", "like")
                        <span class="like-text">
                            {{i.details.likes}} @GeneralResources.Like
                        </span>
                    </div>
                </button>
            </div>

            <div class="item-actions">
                <a target="_blank" user-not-register-popup="click" href="{{i.details.downloadUrl}}" ga-track-event="['itemPage', 'download']">@Html.Svg(svgUrl, "download")</a>
                <a target="_blank" user-not-register-popup="click" href="{{i.details.printUrl}}" ga-track-event="['itemPage', 'print']">@Html.Svg(svgUrl, "print")</a>
                <md-menu flex>
                    <md-button aria-label="open menu" class="md-icon-button" user-not-register-popup="click" ng-click="app.openMenu($mdOpenMenu, $event)" ga-track-event="['itemPage', 'delete']">
                        @Html.Svg("~/images/site/icons.svg", "ThreeDots", new { @class = "dots-3" })
                    </md-button>
                    <md-menu-content width="1">
                        <md-menu-item>
                            <md-button class="text-capitalize" aria-label="delete post" ng-click="i.showRename()" ga-track-event="['itemPage', 'rename']">
                                @GeneralResources.Rename
                            </md-button>
                        </md-menu-item>
                        <md-menu-item>
                            <md-button aria-label="delete post" ng-click="i.selectedState = i.state.flag" ga-track-event="['itemPage', 'flag']">
                                @ItemsResources.Flag
                            </md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>
            </div>
            <button class="close-btn" type="button" ng-click="app.back(i.details.boxUrl)" ga-track-event="['itemPage', 'close']">@Html.Svg("~/images/site/icons.svg", "close")</button>
        </div>
        <md-progress-linear ng-if="i.loader" md-mode="indeterminate"></md-progress-linear>
    </header>

    @*<header>
            <div class="fb-like" ng-class="{blue : i.details.like}">
                <button user-not-register-popup="click" type="button" ng-click="i.like()" ga-track-event="['itemPage', 'like item']">
                    <div class="content">@Html.Svg("~/images/site/box-icons.svg", "like") {{i.details.likes}} @GeneralResources.Like</div>
                </button>
            </div>

            <div class="text-center">
                <a target="_blank" user-not-register-popup="click" href="{{i.details.downloadUrl}}" ga-track-event="['itemPage', 'download']">@Html.Svg(svgUrl, "download")</a>
                <a target="_blank" user-not-register-popup="click" href="{{i.details.printUrl}}" ga-track-event="['itemPage', 'print']">@Html.Svg(svgUrl, "print")</a>
                <md-menu flex>
                    <md-button aria-label="open menu" class="md-icon-button" user-not-register-popup="click" ng-click="app.openMenu($mdOpenMenu, $event)" ga-track-event="['itemPage', 'delete']">
                        @Html.Svg("~/images/site/icons.svg", "ThreeDots", new { @class = "dots-3" })
                    </md-button>
                    <md-menu-content width="1">
                        <md-menu-item>
                            <md-button class="text-capitalize" aria-label="delete post" ng-click="i.showRename()" ga-track-event="['itemPage', 'rename']">
                                @GeneralResources.Rename
                            </md-button>
                        </md-menu-item>
                        <md-menu-item>
                            <md-button aria-label="delete post" ng-click="i.selectedState = i.state.flag" ga-track-event="['itemPage', 'flag']">
                                @ItemsResources.Flag
                            </md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>
            </div>
            <button class="close-btn" type="button" ng-click="app.back(i.details.boxUrl)" ga-track-event="['itemPage', 'close']">@Html.Svg("~/images/site/icons.svg", "close")</button>
            <md-progress-linear ng-if="i.loader" md-mode="indeterminate"></md-progress-linear>
        </header>*@

    <div class="full-screen-body" md-swipe-left="i.swipeLeft()" md-swipe-right="i.swipeRight()">

        <div class="fileName">
            <div class="name-info" layout="row" layout-align="center center" ng-if="i.selectedState === i.state.regular">
                <span class="ellipsis">{{i.details.name}}</span>
                <a class="info" href="#" tooltip-placement="bottom" tooltip-class="copy-right"
                   uib-tooltip="@ItemsResources.CopyRight">@Html.Svg(svgUrl, "info")</a>
            </div>
            <form name="renameItem" class="rename-form" novalidate ng-submit="i.renameItem(renameItem)" ng-if="i.selectedState === i.state.rename">
                <md-content>
                    <md-input-container flex>
                        <label class="text-capitalize">@ItemsResources.Name</label>
                        <input autocomplete="off" required ng-model="i.renameText" name="name" />
                        <div ng-messages="renameItem.name.$error" ng-show="renameItem.name.$dirty">
                            <div ng-message="required">@GeneralResources.RequiredField</div>
                        </div>
                    </md-input-container>
                </md-content>

                <span layout="row" layout-align="end center  text-capitalize">
                    <button type="button" class="btn grey btn-default" ng-click="i.selectedState = i.state.regular" ga-track-event="['itemPage', 'cancel rename']">@GeneralResources.Cancel</button>
                    <button type="submit" class="btn blue" ng-disabled="!renameItem.$valid || i.submitDisabled" ga-track-event="['itemPage', 'save rename']">@ItemsResources.Save</button>
                </span>
            </form>

            @{ Html.RenderPartial("_FlagItem");}
        </div>
        <div class="arrows">
            <a ng-if="i.details.previous" href="{{i.details.previous}}" hide-xs class="arrow left" ga-track-event="['itemPage', 'previous item']">@Html.Svg("~/images/site/icons.svg", "arrow")</a>
            <a ng-if="i.details.next" href="{{i.details.next}}" hide-xs class="arrow right" ga-track-event="['itemPage', 'next item']">@Html.Svg("~/images/site/icons.svg", "arrow")</a>
        </div>
        <div class="comments">
            <div class="new-comment">
                <div class="user-image" ng-controller="UserDetailsController as ud">
                    <a href="{{::ud.url}}" user-not-register-popup=" click" class="username" ga-track-event="['box-feed', 'userNameImage']">
                        <user-image class="img-circle c-img" name="ud.name" image="ud.image" width="54" height="54" noremove="true"></user-image>
                    </a>
                </div>
                <form name="newComment" class="new-comment-form" novalidate ng-submit="i.addComment(newComment)">
                    <input autocomplete="off" required ng-model="i.newCommentText" name="newComment" placeholder="@ItemsResources.NewComment" />
                    @*<div ng-messages="renameItem.name.$error" ng-show="renameItem.name.$dirty">
                            <div ng-message="required">@GeneralResources.RequiredField</div>
                        </div>*@
                </form>
            </div>
            <ul class="comments-list list-unstyled">
                <li ng-repeat="comment in i.details.comments" class="reply">
                    <div class="comment-data">
                        <div class="user-image"></div>
                        <div class="comment-text">
                            <div class="comment-info">Written by NAME in DATE</div>
                            <div>{{::comment.comment}}</div>
                        </div>
                    </div>
                    <ul class="comment-replies list-unstyled">
                        <li ng-repeat="reply in comment.replies" class="reply">{{::reply.comment}}</li>
                    </ul>
                    <button type="button" class=" text-capitalize margins" ng-click="i.openReply(comment)">Comment</button>

                    <form class="add-comment-reply add-reply" ng-if="comment.showFrom" ng-submit="i.addCommentReply(comment)">
                        <md-input-container md-no-float>
                            <textarea autofocus ng-model="i.newCommentReplyText" placeholder="reply"></textarea>
                        </md-input-container>
                        </>
                        <button type="submit" class="btn btn-primary text-uppercase">reply</button>
                        @*<input type="checkbox" ng-model="f.add.anonymous" id="anonymous" />
                            <label for="anonymous" class="pull-right">@Html.Svg("~/images/site/box-icons.svg", "anonymous", new { @class = "anonymous" })</label>*@
                    </form>
                </li>
            </ul>
        </div>
        <div class="preview" ng-bind-html="i.preview">
        </div>
    </div>
</div>
