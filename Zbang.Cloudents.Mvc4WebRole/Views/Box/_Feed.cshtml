@using Zbang.Cloudents.Mvc4WebRole.Views.Box.Resources
@using Zbang.Cloudents.Mvc4WebRole.Views.Shared.Resources

<section class="boxFeed" ng-controller="QnACtrl">
    <form name="qnaQform" ng-submit="postQuestion(qnaQform.$valid)" novalidate ng-init="showPost=false">
        <div class="textareaWpr">
            <img ng-src="{{info.userImage}}" class="QAImg lFloat" alt="" width="32" height="32" />
            <textarea text-direction msd-elastic name="content" class="QTextarea" ng-placeholder="@IndexResources.OnYourMind" required ng-model="qFormData.content" ng-focus="checkAuth() && (showPost=true)"></textarea>
            <ul class="attachedList">
                <li class="attachedItem" ng-repeat="file in qFormData.files">
                    <span class="attachName elps">{{file.name}}</span>
                    <button class="removeAttach" ng-click="removeQuestionAttachment(file)"></button>
                </li>
            </ul>
        </div>
        <div class="bottomTA">
            <button type="button" ng-show="showPost" class="lFloat attachBtn" ng-disabled="!qnaQform.$valid" ng-click="addQuestionAttachment()">
                <svg class="svg-attachment"><use xlink:href="~/Images/Defs.svg#attachment" /></svg>
            </button>
            <button type="submit" ng-show="showPost" class="rFloat askBtn" ng-disabled="!qnaQform.$valid">@SharedResources.Post</button>
        </div>
    </form>

    <ul class="boxFeedList">
        <li class="" ng-repeat="question in info.questions" ng-class="{hasAttached: question.files.length}">
            <img class="QAImg" alt="" width="32" height="32" ng-src="{{question.userImage}}" user-tooltip-popup="{{question.userId}}" />
            <div class="attachBtn"></div>
            <div class="numAttached">{{question.files.length}}</div>
            <div class="userName boldFont elps">{{question.userName}}</div>
            <time class="createTime" display-time="{{question.createTime}}"></time>
            <div class="QContent" ng-bind-html="question.content"></div>

            <ul class="attachedList">
                <li class="attachedItem" ng-repeat="file in qFormData.files">
                    <span class="attachName elps">{{file.name}}</span>
                    <button class="removeAttach" ng-click="removeQuestionAttachment(file)"></button>
                </li>
            </ul>

            <button type="button">@SharedResources.AddComment</button>

            @*<section class="shareBtn rFloat">
                    <input class="checkbox" type="checkbox" id="boxShare" ng-model="popup.share" />
                    <label for="boxShare" tooltip="@SharedResources.Share" class="shareBtnTxt iconTop">
                        <svg class="svg-share"><use xlink:href="~/Images/Defs.svg#share" /></svg>
                    </label>
                    <div class="dropDown shareDD">
                        <label class="closeItem rFloat" for="boxShare"></label>
                        <div class="arrow shareArrow"></div>
                        <h4 class="semiFont">{{strings.share}}</h4>
                        <div class="shareTxt">{{strings.invite}}</div>
                        <ul class="shareList">
                            <li class="shareItem"><button type="button" class="fbShare" ng-click="shareFacebook()">@SharedResources.Facebook</button></li>

                            @if (User.Identity.IsAuthenticated)
                            {
                                <li class="shareItem"><button type="button" class="emailShare" ng-click="shareEmail()">@SharedResources.Email</button></li>
                            }
                        </ul>
                        <div class="shareTxt">@SharedResources.OrCopyLink</div>
                        <input type="text" class="linkShare" ng-model="info.url" readonly="readonly" select-on-click />
                    </div>
                </section>*@

            @*<span user-tooltip-popup="{{comment.userId}}" class="user-name">{{comment.userName}}</span>
                <time display-time="{{comment.creationDate}}"></time>
                <p>{{comment.comment}}</p>*@
            <ul>
                <li ng-repeat="answer in info.selectedQuestion.answers">
                    <img class="QAImg lFloat" user-tooltip-popup="{{question.userId}}" ng-src="{{answer.userImage}}" alt="" width="32" height="32" />
                    <div class="userName boldFont elps">{{answer.userName}}</div>
                    <time class="createTime innerSection" display-time="{{answer.createTime}}"></time>
                    <div class="AContent" ng-bind-html="answer.content"></div>
                    <ul class="qaAttach">
                        <li class="qaAttachItem" ng-repeat="file in answer.files">
                            <a ng-href="{{file.itemUrl}}"><img ng-src="{{file.thumbnail}}" alt="" width="100" height="125" /></a>
                            <div class="attachActions">
                                <a class="attachFull" ng-href="{{file.itemUrl}}"></a>
                                <button class="attachDelete" type="button" ng-if="file.isVisible" ng-click="removeAttachment(answer,file)"></button>
                                <a class="attachDownload" target="_blank" ng-href="{{item.download}}"></a>
                            </div>
                        </li>
                    </ul>
                </li>
            </ul>

            @*<form name="addReplyF" novalidate ng-submit="addReply(comment)" class="clearfix itemCommentsForm" ng-show="comment.showReplyF">*@
            <div ng-form="qnaAform" class="clearfix" novalidate ng-init="showComment=false">
                <img class="QAImg lFloat" ng-src="{{info.userImage}}" alt="" width="32" height="32" />
                <div class="textareaWpr">
                    <textarea text-direction msd-elastic name="content" required class="QTextarea" ng-placeholder="@SharedResources.WriteComment" ng-model="info.selectedQuestion.aFormData.content" ng-focus="checkAuth() && (showComment=true)"></textarea>
                    <ul class="attachedList">
                        <li class="attachedItem" ng-repeat="file in info.selectedQuestion.aFormData.files">
                            <span class="attachName elps">{{file.name}}</span>
                            <button class="removeAttach" ng-click="removeAnswerAttachment(info.selectedQuestion,file)"></button>
                        </li>
                    </ul>
                </div>
                <div class="rFloat">
                    <button type="button" class="attachBtn" ng-show="showComment" ng-click="addAnswerAttachment(info.selectedQuestion)"></button>
                    <button type="submit" class="askBtn" ng-click="postAnswer(info.selectedQuestion)" ng-disabled="!qnaAform.$valid" ng-show="showComment">@SharedResources.Comment</button>
                </div>
            </div>
            @*</form>*@
        </li>
    </ul>

</section>
