(function(n){jQuery.fn.extend({slimScroll:function(i){var r=n.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},i);return this.each(function(){function y(t){var i,f;l&&(t=t||window.event,i=0,t.wheelDelta&&(i=-t.wheelDelta/120),t.detail&&(i=t.detail/16),f=t.target||t.srcTarget||t.srcElement,n(f).closest("."+r.wrapperClass).is(u.parent())&&h(i,!0),t.preventDefault&&!s&&t.preventDefault(),s||(t.returnValue=!1))}function h(n,t,i){var e,l,h;s=!1;e=n;l=u.outerHeight()-f.outerHeight();t&&(e=parseInt(f.css("top"),10)+n*parseInt(r.wheelStep,10)/100*f.outerHeight(),e=Math.min(Math.max(e,0),l),e=n>0?Math.ceil(e):Math.floor(e),f.css({top:e+"px"}));o=parseInt(f.css("top"),10)/(u.outerHeight()-f.outerHeight());e=o*(u[0].scrollHeight-u.outerHeight());i&&(e=n,h=e/u[0].scrollHeight*u.outerHeight(),h=Math.min(Math.max(h,0),l),f.css({top:h+"px"}));u.scrollTop(e);u.trigger("slimscrolling",~~e);g();c()}function ft(){window.addEventListener?(this.addEventListener("DOMMouseScroll",y,!1),this.addEventListener("mousewheel",y,!1),this.addEventListener("MozMousePixelScroll",y,!1)):document.attachEvent("onmousewheel",y)}function d(){a=Math.max(u.outerHeight()/u[0].scrollHeight*u.outerHeight(),ut);f.css({height:a+"px"});var n=a==u.outerHeight()?"none":"block";f.css({display:n})}function g(){if(d(),clearTimeout(nt),o==~~o){if(s=r.allowPageScroll,tt!=o){var n=~~o==0?"top":"bottom";u.trigger("slimscroll",n)}}else s=!1;if(tt=o,a>=u.outerHeight()){s=!0;return}f.stop(!0,!0).fadeIn("fast");r.railVisible&&e.stop(!0,!0).fadeIn("fast")}function c(){r.alwaysVisible||(nt=setTimeout(function(){r.disableFadeOut&&l||p||w||(f.fadeOut("slow"),e.fadeOut("slow"))},1e3))}var l,p,w,nt,b,a,o,tt,k="<div><\/div>",ut=30,s=!1,u=n(this),v,it;if(u.parent().hasClass(r.wrapperClass)){if(v=u.scrollTop(),f=u.parent().find("."+r.barClass),e=u.parent().find("."+r.railClass),d(),n.isPlainObject(i)){if("height"in i&&(u.parent().css("height",i.height),u.css("height",i.height)),"scrollTo"in i)v=parseInt(r.scrollTo,10);else if("scrollBy"in i)v+=parseInt(r.scrollBy,10);else if("destroy"in i){f.remove();e.remove();u.unwrap();u.css({overflow:"",width:"",height:""});return}h(v,!1,!0)}return}r.height=r.height=="auto"?u.parent().height():r.height;it=n(k).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});u.css({overflow:"hidden",width:r.width,height:r.height});var e=n(k).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:9}),f=n(k).addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:10}),rt=r.position=="right"?{right:r.distance}:{left:r.distance};e.css(rt);f.css(rt);u.wrap(it);u.parent().append(f);u.parent().append(e);r.railDraggable&&f.bind("mousedown",function(i){var r=n(document);return w=!0,t=parseFloat(f.css("top")),pageY=i.pageY,r.bind("mousemove.slimscroll",function(n){currTop=t+n.pageY-pageY;f.css("top",currTop);h(0,f.position().top,!1)}),r.bind("mouseup.slimscroll",function(){w=!1;c();r.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(n){return n.stopPropagation(),n.preventDefault(),!1});e.hover(function(){g()},function(){c()});f.hover(function(){p=!0},function(){p=!1});u.hover(function(){l=!0;g();c()},function(){l=!1;c()});u.bind("touchstart",function(n){console.log("here");n.originalEvent.touches.length&&(b=n.originalEvent.touches[0].pageY)});u.bind("touchmove",function(n){if(s||n.originalEvent.preventDefault(),n.originalEvent.touches.length){var t=(b-n.originalEvent.touches[0].pageY)/r.touchScrollStep;h(t,!0);b=n.originalEvent.touches[0].pageY}});d();f.hide();e.hide();r.start==="bottom"?(f.css({top:u.outerHeight()-f.outerHeight()}),h(0,!0)):r.start!=="top"&&(h(n(r.start).position().top,null,!0),r.alwaysVisible||f.hide());ft()}),this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery);