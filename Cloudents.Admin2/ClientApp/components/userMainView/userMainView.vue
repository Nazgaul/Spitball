<template>
    <v-container>
        <v-form ref="form" lazy-validation  
         @submit.prevent="submitUserData"
          >
            <v-layout row>
                <v-flex xs3>
                    <v-text-field solo v-model="userIdentifier"
                                  autofocus
                                  type="text"
                                  required
                                  :rules="requiredRules"
                                  placeholder="Insert user identifier..." 
                                  @keyup.enter="submitUserData()"/>
                </v-flex>
                <v-btn color="success"
                       @click="submitUserData()"
                       >
                    Get User
                </v-btn>
                <v-spacer></v-spacer>
                <v-flex xs4 v-if="showActions">
                    <v-btn v-if="!userStatusActive && !suspendedUser" :disabled="!showActions" color="red lighten-2"
                           @click="showSuspendDialog()">
                        Suspend
                    </v-btn>
                    <v-btn v-else color="teal lighten-1" @click="releaseUser()">UnSuspend</v-btn>

                    <v-btn :disabled="!showActions" color="light-green lighten-2" @click="openTokensDialog()">
                        Grant Tokens
                    </v-btn>
                </v-flex>
            </v-layout>
        </v-form>
        <v-layout>
            <v-flex xs2 v-if="showActions">
                <v-list dense class="elevation-2">
                    <template v-for="(infoItem, name,index) in userInfo">
                        <v-list-tile :class="[ (index % 2 == 0) ? 'teal lighten-4' : 'cyan lighten-5' ]">
                            <v-layout justify-space-between>
                                <span>{{infoItem.label}}</span>
                                <span>{{infoItem.value}}</span>
                            </v-layout>
                        </v-list-tile>
                        <v-divider></v-divider>
                    </template>
                </v-list>
            </v-flex>
            <v-spacer></v-spacer>
            <v-flex xs10 class="ml-2">
                <v-tabs centered color="light-green">
                    <v-tab :to="{name: 'userQuestions', params : {userId: userId} }">Question</v-tab>
                    <v-tab :to="{name: 'userAnswers', params:{userId: userId}}">Answers</v-tab>
                    <v-tab :to="{name: 'userDocuments', params:{userId: userId}}">Documents</v-tab>
                    <v-tab :to="{name: 'userPurchasedDocuments', params:{userId: userId}}">Purchased Documents</v-tab>
                    <v-tab :to="{name: 'userConversations', params:{userId: userId}}">Conversations</v-tab>
                    <v-tab :to="{name: 'userSessions', params:{userId: userId}}">Sessions</v-tab>
                </v-tabs>
                <div class="filters mb-2">
                    <v-btn v-for="(filter, index) in filters" @click="updateFilter(filter.value)"
                           :color="filterValue === filter.value ? 'blue lighten-1' : ''  "
                           :key="'filter_'+index">
                        {{filter.name}}
                    </v-btn>
                </div>
                <v-tabs-items>
                    <router-view :userId="userId" :needScroll="needScroll">
                    </router-view>
                    <div class="d-flex justify-center align-center" v-if="loader">
                        <div class="text-xs-center">
                        <v-progress-circular :size="100"
                                            :width="5"
                                             color="primary"
                                             indeterminate>
                            Loading...
                        </v-progress-circular>
                        </div>
                    </div>
                  

                </v-tabs-items>
            </v-flex>
        </v-layout>
        <v-dialog v-model="suspendDialogState" persistent max-width="600px" v-if="suspendDialogState">
            <v-card>
                <v-card-title>
                    <span class="headline">Suspend User</span>
                </v-card-title>
                <v-card-text>
                    <v-container grid-list-md>
                        <v-layout wrap>
                            <v-flex xs12 sm12 md12>
                                <userSuspend :userIds="userId"></userSuspend>
                            </v-flex>
                        </v-layout>
                    </v-container>
                </v-card-text>
                <v-card-actions>
                    <v-spacer></v-spacer>
                    <v-btn color="blue darken-1" flat @click="closeSuspendDialog()">Cancel</v-btn>
                </v-card-actions>
            </v-card>
        </v-dialog>
        <v-dialog v-model="getTokensDialogState" persistent max-width="600px" v-if="getTokensDialogState">
            <v-card>
                <v-card-title>
                    <span class="headline">Grant Tokens</span>
                </v-card-title>
                <v-card-text>
                    <v-container grid-list-md>
                        <v-layout wrap>
                            <v-flex xs12 sm12 md12>
                                <user-tokens :userId="userId"></user-tokens>
                            </v-flex>
                        </v-layout>
                    </v-container>
                </v-card-text>
                <v-card-actions>
                    <v-spacer></v-spacer>
                    <v-btn color="blue darken-1" flat @click="closeTokensDialog()">Close</v-btn>
                    <v-btn color="blue darken-1" flat @click="closeTokensDialog()">Cancel</v-btn>
                </v-card-actions>
            </v-card>
        </v-dialog>
    </v-container>
</template>

<script src="./userMainView.js">

</script>

