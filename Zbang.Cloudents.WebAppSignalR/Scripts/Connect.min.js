$(function(){function e(n){u?i.invoke.apply(i,n):t.push(n)}function n(n){parent.postMessage(n,f)}var r=$.hubConnection(),u=!1,t=[],i=r.createHubProxy("notificationHub"),f=document.getElementById("form1").getAttribute("data-parent");i.on("fileAdded",function(t,i){n(["addedItem",{item:t,boxid:i}])}).on("fileRemoved",function(t){n(["removeItem",t])}).on("questionAdded",function(t,i){n(["addQuestion",{boxid:t,question:i}])}).on("questionRemoved",function(t,i){n(["removeQuestion",i])}).on("answerAdded",function(t,i,r){n(["addAnswer",{questionid:t,answer:i,box:r}])}).on("answerRemoved",function(t,i){n(["removeAnswer",{questionid:t,answerid:i}])}).on("InviteUser",function(){n(["inviteuser"])});r.start().done(function(){u=!0;for(var n=0;n<t.length;n++)e(t[n])}).fail(function(){console.log("fail")});n(["loaded"]);window.addEventListener("message",function(n){var t,i;n.origin===f&&(t=JSON.parse(n.data),$.isArray(t))&&(i=t[0],e(t))},!1)});