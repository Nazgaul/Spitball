(function(n){"use strict";var t=window.angulartics||(window.angulartics={});t.waitForVendorCount=0;t.waitForVendorApi=function(n,i,r,u,f){f||t.waitForVendorCount++;u||(u=r,r=undefined);Object.prototype.hasOwnProperty.call(window,n)&&(r===undefined||window[n][r]!==undefined)?(t.waitForVendorCount--,u(window[n])):setTimeout(function(){t.waitForVendorApi(n,i,r,u,!0)},i)};n.module("angulartics",[]).provider("$analytics",function(){var i={pageTracking:{autoTrackFirstPage:!0,autoTrackVirtualPages:!0,trackRelativePath:!1,autoBasePath:!1,basePath:""},eventTracking:{},bufferFlushDelay:1e3},r={},u={},s=function(n){return function(){t.waitForVendorCount&&(r[n]||(r[n]=[]),r[n].push(arguments))}},e=function(t,i){return u[t]||(u[t]=[]),u[t].push(i),function(){var i=arguments;n.forEach(u[t],function(n){n.apply(this,i)},this)}},f={settings:i},h=function(n,t){t?setTimeout(n,t):n()},o={$get:function(){return f},api:f,settings:i,virtualPageviews:function(n){this.settings.pageTracking.autoTrackVirtualPages=n},firstPageview:function(n){this.settings.pageTracking.autoTrackFirstPage=n},withBase:function(t){this.settings.pageTracking.basePath=t?n.element("base").attr("href").slice(0,-1):""},withAutoBase:function(n){this.settings.pageTracking.autoBasePath=n}},c=function(t,u){f[t]=e(t,u);var o=i[t],s=o?o.bufferFlushDelay:null,c=s!==null?s:i.bufferFlushDelay;n.forEach(r[t],function(n,t){h(function(){u.apply(this,n)},t*c)})},l=function(n){return n.replace(/^./,function(n){return n.toUpperCase()})},a=function(n){var t="register"+l(n);o[t]=function(t){c(n,t)};f[n]=e(n,s(n))};return n.forEach(["pageTrack","eventTrack","setVariable","socialTrack","timingTrack","setUsername","setUserProperties","setUserPropertiesOnce","setSuperProperties","setSuperPropertiesOnce"],a),o}).run(["$rootScope","$location","$window","$analytics","$injector",function(n,t,i,r,u){var f,e,h,o,c,s;if(r.settings.pageTracking.autoTrackFirstPage){if(f=!0,u.has("$route")){e=u.get("$route");for(h in e.routes){f=!1;break}}else if(u.has("$state")){o=u.get("$state");for(c in o.get()){f=!1;break}}else f=!1;f&&(r.settings.pageTracking.autoBasePath&&(r.settings.pageTracking.basePath=i.location.pathname),r.settings.trackRelativePath?(s=r.settings.pageTracking.basePath+t.url(),r.pageTrack(s)):r.pageTrack(t.absUrl()))}r.settings.pageTracking.autoTrackVirtualPages&&(r.settings.pageTracking.autoBasePath&&(r.settings.pageTracking.basePath=i.location.pathname+"#"),u.has("$route")&&n.$on("$routeChangeSuccess",function(n,i){if(!i||!(i.$$route||i).redirectTo){var u=r.settings.pageTracking.basePath+t.url();r.pageTrack(u)}}),u.has("$state")&&n.$on("$stateChangeSuccess",function(){var n=r.settings.pageTracking.basePath+t.url();r.pageTrack(n)}))}]).directive("analyticsOn",["$analytics","$timeout",function(t){function i(n){return["a:","button:","button:button","button:submit","input:button","input:submit"].indexOf(n.tagName.toLowerCase()+":"+(n.type||""))>=0}function r(n){return i(n),"click"}function u(n){return i(n)?n.innerText||n.value:n.id||n.name||n.tagName}function f(n){return n.substr(0,9)==="analytics"&&["On","Event","If","Properties","EventType"].indexOf(n.substr(9))===-1}function e(n){var t=n.slice(9);return typeof t!="undefined"&&t!==null&&t.length>0?t.substring(0,1).toLowerCase()+t.substring(1):t}return{restrict:"A",scope:!0,link:function(i,o,s){var h=s.analyticsOn||r(o[0]);i.$analytics={};n.forEach(s.$attr,function(n,t){f(t)&&s.$observe(t,function(n){i.$analytics[e(t)]=n})});n.element(o[0]).bind(h,function(r){var f=s.analyticsEvent||u(o[0]);(i.$analytics.eventType=r.type,!s.analyticsIf||i.$eval(s.analyticsIf))&&(s.analyticsProperties&&n.extend(i.$analytics,i.$eval(s.analyticsProperties)),t.eventTrack(f,i.$analytics))})}}}]).directive("analyticsSocial",["$analytics","$timeout",function(t){function i(n){return["a:","button:","button:button","button:submit","input:button","input:submit"].indexOf(n.tagName.toLowerCase()+":"+(n.type||""))>=0}function r(n){return i(n),"click"}function u(n){return i(n)?n.innerText||n.value:n.id||n.name||n.tagName}function f(n){return n.substr(0,9)==="analytics"&&["On","Event","If","Properties","EventType"].indexOf(n.substr(9))===-1}function e(n){var t=n.slice(9);return typeof t!="undefined"&&t!==null&&t.length>0?t.substring(0,1).toLowerCase()+t.substring(1):t}return{restrict:"A",scope:!0,link:function(i,o,s){var h=s.analyticsOn||r(o[0]);i.$analytics={};n.forEach(s.$attr,function(n,t){f(t)&&s.$observe(t,function(n){i.$analytics[e(t)]=n})});n.element(o[0]).bind(h,function(r){var f=s.analyticsEvent||u(o[0]);(i.$analytics.eventType=r.type,!s.analyticsIf||i.$eval(s.analyticsIf))&&(s.analyticsProperties&&n.extend(i.$analytics,i.$eval(s.analyticsProperties)),t.socialTrack(f,i.$analytics))})}}}])})(angular);