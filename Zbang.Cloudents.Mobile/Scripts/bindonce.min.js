(function(){"use strict";var n=angular.module("pasvaz.bindonce",[]);n.directive("bindonce",function(){var t=function(n){if(n&&n.length!==0){var t=angular.lowercase(""+n);n=!(t==="f"||t==="0"||t==="false"||t==="no"||t==="n"||t==="[]")}else n=!1;return n},n=parseInt((/msie (\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10);return isNaN(n)&&(n=parseInt((/trident\/.*; rv:(\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10)),{restrict:"AM",controller:["$scope","$element","$attrs","$interpolate",function(i,r,u,f){var o=function(n,i,r){var u=i==="show"?"":"none",f=i==="hide"?"":"none";n.css("display",t(r)?u:f)},s=function(n,t){if(angular.isObject(t)&&!angular.isArray(t)){var i=[];angular.forEach(t,function(n,t){n&&i.push(t)});t=i}t&&n.addClass(angular.isArray(t)?t.join(" "):t)},e=function(n,t){n.transclude(t,function(t){var r=n.element.parent(),i=n.element&&n.element[n.element.length-1],u=r&&r[0]||i&&i.parentNode,f=i&&i.nextSibling||null;angular.forEach(t,function(n){u.insertBefore(n,f)})})};return{watcherRemover:undefined,binders:[],group:u.boName,element:r,ran:!1,addBinder:function(n){this.binders.push(n);this.ran&&this.runBinders()},setupWatcher:function(n){var t=this;this.watcherRemover=i.$watch(n,function(n){n!==undefined&&(t.removeWatcher(),t.checkBindonce(n))},!0)},checkBindonce:function(n){var t=this,i=n.$promise?n.$promise.then:n.then;typeof i=="function"?i(function(){t.runBinders()}):t.runBinders()},removeWatcher:function(){this.watcherRemover!==undefined&&(this.watcherRemover(),this.watcherRemover=undefined)},runBinders:function(){for(var i,r,c,h,u;this.binders.length>0;)if(i=this.binders.shift(),!this.group||this.group==i.group){r=i.scope.$eval(i.interpolate?f(i.value):i.value);switch(i.attr){case"boIf":t(r)&&e(i,i.scope.$new());break;case"boSwitch":h=i.controller[0];(c=h.cases["!"+r]||h.cases["?"])&&(i.scope.$eval(i.attrs.change),angular.forEach(c,function(n){e(n,i.scope.$new())}));break;case"boSwitchWhen":u=i.controller[0];u.cases["!"+i.attrs.boSwitchWhen]=u.cases["!"+i.attrs.boSwitchWhen]||[];u.cases["!"+i.attrs.boSwitchWhen].push({transclude:i.transclude,element:i.element});break;case"boSwitchDefault":u=i.controller[0];u.cases["?"]=u.cases["?"]||[];u.cases["?"].push({transclude:i.transclude,element:i.element});break;case"hide":case"show":o(i.element,i.attr,r);break;case"class":s(i.element,r);break;case"text":i.element.text(r);break;case"html":i.element.html(r);break;case"style":i.element.css(r);break;case"src":i.element.attr(i.attr,r);n&&i.element.prop("src",r);break;case"attr":angular.forEach(i.attrs,function(n,t){var r,u;t.match(/^boAttr./)&&i.attrs[t]&&(r=t.replace(/^boAttr/,"").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),u=i.scope.$eval(i.attrs[t]),i.element.attr(r,u))});break;case"href":case"alt":case"title":case"id":case"value":i.element.attr(i.attr,r)}}this.ran=!0}}}],link:function(n,t,i,r){var u=i.bindonce&&n.$eval(i.bindonce);u!==undefined?r.checkBindonce(u):(r.setupWatcher(i.bindonce),t.bind("$destroy",r.removeWatcher))}}});angular.forEach([{directiveName:"boShow",attribute:"show"},{directiveName:"boHide",attribute:"hide"},{directiveName:"boClass",attribute:"class"},{directiveName:"boText",attribute:"text"},{directiveName:"boBind",attribute:"text"},{directiveName:"boHtml",attribute:"html"},{directiveName:"boSrcI",attribute:"src",interpolate:!0},{directiveName:"boSrc",attribute:"src"},{directiveName:"boHrefI",attribute:"href",interpolate:!0},{directiveName:"boHref",attribute:"href"},{directiveName:"boAlt",attribute:"alt"},{directiveName:"boTitle",attribute:"title"},{directiveName:"boId",attribute:"id"},{directiveName:"boStyle",attribute:"style"},{directiveName:"boValue",attribute:"value"},{directiveName:"boAttr",attribute:"attr"},{directiveName:"boIf",transclude:"element",terminal:!0,priority:1e3},{directiveName:"boSwitch",require:"boSwitch",controller:function(){this.cases={}}},{directiveName:"boSwitchWhen",transclude:"element",priority:800,require:"^boSwitch"},{directiveName:"boSwitchDefault",transclude:"element",priority:800,require:"^boSwitch"}],function(t){var i=200;return n.directive(t.directiveName,function(){return{priority:t.priority||i,transclude:t.transclude||!1,terminal:t.terminal||!1,require:["^bindonce"].concat(t.require||[]),controller:t.controller,compile:function(n,i,r){return function(n,i,u,f){var e=f[0],s=u.boParent,o,h;if(s&&e.group!==s){for(o=e.element.parent(),e=undefined;o[0].nodeType!==9&&o.length;){if((h=o.data("$bindonceController"))&&h.group===s){e=h;break}o=o.parent()}if(!e)throw new Error("No bindonce controller: "+s);}e.addBinder({element:i,attr:t.attribute||t.directiveName,attrs:u,value:u[t.directiveName],interpolate:t.interpolate,group:s,transclude:r,controller:f.slice(1),scope:n})}}}})})})();